\section{Theory}

A seismic image is built under the underlying assumption of single 
scattering \textcolor{red}{(cite Claerbout, 1971 here)}, many efforts an advances has been made
since then until now. We went from post-stack migration, to Pre-stack migration
using ray based methods \textcolor{red}{(Kirchoff, beam, etc)} to wave equation migration methods
\textcolor{red}{(WEM, RTM)}.

The first approximations to the wave equation led us to one-way methods, implictly
theese mehtods cannot handle overturning waves.  Later on, helped by the increasing
computing power made feaseble the use of reverse time migration (RTM)  \textcolor{red}{(cite Baysal, and others)}. 
With RTM we have the ability to image the all dips and waves travelling in any direction (becasue of its
two-way nature).  


The conventional imaging codition (I.C.) is a zero lag cross-correlation of the downgoing wavefield (source 
wavefield) with the upgoing wavefield (receiver wavefield). This suposition of ``downgoing" or ``upgoing"
is based on the single scattering cosideration. Perhaps the source wavefield is not always ``downgoing" (e.g.
diving waves).

When the model we use for migration contains abrupt changes scattered will be generated by the interface,
therefore we will have part of the source or receiver wavefield going in the oposite direction as its expected 
by the conventional IC shown in equation ~\ref{eq:IC}.


\beq
R(\bf{x})= \sum_{shots} \sum_t \US(\bf{x},t) \UR(\bf{x},t),
\label{eq:IC}
\eeq

The backscatered energy of the wavefields cross-correlates too and can be appriciated as low frequency energy
in the image. We always try to remove this energy using some kind of filter on the image domain \textcolor{red}{(citar Antoine, laplace,
etc, etc)} or in the extended image domain \textcolor{red}{(citar bruno )}.

This backscattered energy is undesired in the final image because it masks the geological information. When we have a 
hard interface the source wavefield has two components:
\beq
\US= \US^b + \US^n
\eeq
where $^b$ means backscattered energy and $^n$ means non-backscattered wavefield. The same logic applies to 
the receiver wavefield:
\beq
\UR= \UR^b + \UR^n.
\eeq

By introducing theese new cases we can say that the RTM image is a linear combination between all the cases:

\beq
R(\bf{x})= R(\bf{x})^{nn} +R(\bf{x})^{nb}+R(\bf{x})^{bn}+ R(\bf{x})^{bb}.
\label{eq:cases}
\eeq

Whatever combination but $\bf^{nn}$ will generate undesired incoherent low frequency energy in our image, and therefore
is considered as noise.

This undesired energy could carry some kinematic information thought,  which could be used for velocity update. In this abstract 
I show for very simple models that we can extract velocity errors from it. To do an analisys of the velocity errors we need image gathers.
 For RTM extended images \textcolor{red}{(citar a Rickeckt and Paul, Paul and Sergey)} are straight forward to extract:

\beq
R(\bf{x_a},\bf{\lambda},\tau) =  \sum_{shots} \sum_t \US(\bf{x}-\bf{\lambda},t-\tau) \UR(\bf{x}+\bf{\lambda},t+\tau),
\eeq
to make feaseble the velocity analysis we normally perform the analysis in a subset of the image ($\bf{x_a} \in \bf{x}$).



